{"version":3,"file":"assets/js/posts_java_spring_spring-security.html.58dbb408.js","mappings":";wLACAA,OAAOC,eAAeC,EAAS,aAAc,CAAEC,OAAO,IAGtDD,EAAA,QAAkB,CAACE,EAAKC,KACpB,MAAMC,EAASF,EAAIG,WAAaH,EAChC,IAAK,MAAOI,EAAKC,KAAQJ,EACrBC,EAAOE,GAAOC,EAElB,OAAOH,CAAM,+bCTP,wBA8SJ,yBA9SN,2roFCCA,MAAMI,EAAOC,KAAKC,MAAM,qhsBCAxB,MAAMC,EAAS,CAAC,EAKhB,GAFiC,+DAAgBA,EAAQ,CAAC,CAAC,SAAS,EAAAC","sources":["webpack://healer-blog/./node_modules/vue-loader/dist/exportHelper.js","webpack://healer-blog/./src/.vuepress/.temp/pages/posts/java/spring/spring-security.html.vue","webpack://healer-blog/./src/.vuepress/.temp/pages/posts/java/spring/spring-security.html.js","webpack://healer-blog/./src/.vuepress/.temp/pages/posts/java/spring/spring-security.html.vue?542d"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","<template><div><h1 id=\"spring-security\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#spring-security\"><span>Spring Security</span></a></h1>\n<h2 id=\"基础配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#基础配置\"><span>基础配置</span></a></h2>\n<h3 id=\"_1-安全配置\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-安全配置\"><span>1. 安全配置</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">@</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Configuration</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">@</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">EnableWebSecurity</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> SecurityConfig</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> extends</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> WebSecurityConfigurerAdapter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> configure</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">HttpSecurity</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> http</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        http</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 1. 授权配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">authorizeRequests</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">antMatchers</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/home\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/public/**\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">permitAll</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">antMatchers</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/admin/**\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">hasRole</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"ADMIN\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">antMatchers</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/user/**\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">hasRole</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"USER\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">anyRequest</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">authenticated</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">and</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 2. 登录配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">formLogin</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">loginPage</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/login\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">permitAll</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">and</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 3. 登出配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">logout</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">logoutSuccessUrl</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">permitAll</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">and</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 4. 记住我配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">rememberMe</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">tokenValiditySeconds</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">86400</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">and</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 5. 异常处理</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">exceptionHandling</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">accessDeniedPage</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/403\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    protected</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> configure</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">AuthenticationManagerBuilder</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> auth</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 1. 内存认证</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">        auth</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">inMemoryAuthentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">withUser</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"user\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">password</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"password\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">roles</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"USER\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">and</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">withUser</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"admin\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">password</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"admin\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)).</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">roles</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"ADMIN\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 2. 数据库认证</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">        auth</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">userDetailsService</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(userDetailsService)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Bean</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> PasswordEncoder</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        return</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> BCryptPasswordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_2-用户认证\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-用户认证\"><span>2. 用户认证</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserAuthentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 1. 用户实体</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Entity</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Table</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"users\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> User</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> implements</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Id</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">GeneratedValue</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">strategy</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> GenerationType</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">IDENTITY</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Long</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> id</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> password</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> boolean</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> enabled</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">ManyToMany</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">fetch</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> FetchType</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">EAGER</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">JoinTable</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">name</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"user_roles\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Set</span><span style=\"--shiki-light:#E45649;--shiki-dark:#ABB2BF\">&#x3C;</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">Role</span><span style=\"--shiki-light:#E45649;--shiki-dark:#ABB2BF\">></span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> roles </span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">=</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> HashSet</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">&#x3C;></span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Collection</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">&#x3C;</span><span style=\"--shiki-light:#C18401;--shiki-dark:#C678DD\">?</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> extends</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> GrantedAuthority</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">></span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> getAuthorities</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> roles</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">stream</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">map</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(role </span><span style=\"--shiki-light:#C18401;--shiki-dark:#C678DD\">-></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> SimpleGrantedAuthority</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">role</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getName</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">collect</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">Collectors</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">toList</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">        // 其他 UserDetails 接口方法实现</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 2. 用户服务</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserDetailsServiceImpl</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> implements</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserDetailsService</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserRepository</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> userRepository</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserDetails</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> loadUserByUsername</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">String</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#61AFEF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UsernameNotFoundException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            User</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> user</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> userRepository</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">findByUsername</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(username)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">orElseThrow</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(() </span><span style=\"--shiki-light:#C18401;--shiki-dark:#C678DD\">-></span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> UsernameNotFoundException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"User not found\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">));</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> user;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_3-权限控制\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-权限控制\"><span>3. 权限控制</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> PermissionControl</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 1. 方法级安全</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Service</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserService</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">PreAuthorize</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"hasRole('ADMIN')\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> deleteUser</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">Long</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> id</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 删除用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">PreAuthorize</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"hasRole('ADMIN') or #username == authentication.name\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> User</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> getUser</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">String</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">            // 获取用户</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 2. 注解式安全</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Controller</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserController</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Secured</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"ROLE_ADMIN\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">GetMapping</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/admin\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> String</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> adminPage</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"admin\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">RolesAllowed</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"ROLE_USER\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">GetMapping</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"/user\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> String</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> userPage</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\"> \"user\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"高级特性\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#高级特性\"><span>高级特性</span></a></h2>\n<h3 id=\"_1-oauth2-认证\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_1-oauth2-认证\"><span>1. OAuth2 认证</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">@</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Configuration</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">@</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">EnableAuthorizationServer</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> OAuth2Config</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> extends</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AuthorizationServerConfigurerAdapter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AuthenticationManager</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> authenticationManager</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> configure</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">ClientDetailsServiceConfigurer</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> clients</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Exception</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">        clients</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">inMemory</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">withClient</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"client\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">secret</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">encode</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"secret\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">))</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">authorizedGrantTypes</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"password\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"refresh_token\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">scopes</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"read\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"write\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">accessTokenValiditySeconds</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">3600</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">refreshTokenValiditySeconds</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">86400</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> configure</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">AuthorizationServerEndpointsConfigurer</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> endpoints</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        endpoints</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">authenticationManager</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(authenticationManager)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">userDetailsService</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(userDetailsService);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_2-jwt-认证\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_2-jwt-认证\"><span>2. JWT 认证</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> JWTExample</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 1. JWT 配置</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Configuration</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> JwtConfig</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"${jwt.secret}\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> secret</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Value</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"${jwt.expiration}\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Long</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> expiration</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Bean</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> JwtTokenUtil</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> jwtTokenUtil</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> JwtTokenUtil</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(secret, expiration);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 2. JWT 过滤器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> JwtAuthenticationFilter</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> extends</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> OncePerRequestFilter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> JwtTokenUtil</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> jwtTokenUtil</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        protected</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> void</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> doFilterInternal</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">HttpServletRequest</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">                HttpServletResponse</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> response</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">FilterChain</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> chain</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> ServletException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">,</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> IOException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> token</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> getTokenFromRequest</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(request);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (token </span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\">!=</span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\"> null</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> &#x26;&#x26;</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> jwtTokenUtil</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">validateToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(token)) {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">                String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> jwtTokenUtil</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getUsernameFromToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(token);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">                UserDetails</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> userDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> userDetailsService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">loadUserByUsername</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(username);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">                UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                    new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                        userDetails, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">userDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getAuthorities</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">                SecurityContextHolder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getContext</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">()</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                    .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">setAuthentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(authentication);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">            chain</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">doFilter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(request, response);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h3 id=\"_3-自定义认证\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#_3-自定义认证\"><span>3. 自定义认证</span></a></h3>\n<div class=\"language-java line-numbers-mode\" data-highlighter=\"shiki\" data-ext=\"java\" style=\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\"><pre class=\"shiki shiki-themes one-light one-dark-pro vp-code\" v-pre=\"\"><code><span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> CustomAuthentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 1. 自定义认证提供者</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Component</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> CustomAuthenticationProvider</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> implements</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AuthenticationProvider</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Autowired</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        private</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> UserDetailsService</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> userDetailsService</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Authentication</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> authenticate</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">Authentication</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AuthenticationException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getName</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> password</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getCredentials</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">toString</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            UserDetails</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> userDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> userDetailsService</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                .</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">loadUserByUsername</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(username);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            if</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> (</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">passwordEncoder</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">matches</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(password, </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">userDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getPassword</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">())) {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                return</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                    userDetails, </span><span style=\"--shiki-light:#986801;--shiki-dark:#D19A66\">null</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">, </span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">userDetails</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getAuthorities</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">());</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            throw</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> BadCredentialsException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"Invalid password\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> boolean</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> supports</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">Class</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">&#x3C;</span><span style=\"--shiki-light:#C18401;--shiki-dark:#C678DD\">?</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">> </span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\">authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> authentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">equals</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">class</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">    </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\">    // 2. 自定义认证过滤器</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">    public</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> class</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> CustomAuthenticationFilter</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> extends</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AbstractAuthenticationProcessingFilter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> CustomAuthenticationFilter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">String</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> defaultFilterProcessesUrl</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\">            super</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(defaultFilterProcessesUrl);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#E06C75\">        </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        @</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\">Override</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">        public</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> Authentication</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> attemptAuthentication</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">HttpServletRequest</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">                HttpServletResponse</span><span style=\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\"> response</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">)</span><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\"> throws</span><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\"> AuthenticationException</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> {</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> username</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getParameter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"username\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            String</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> password</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> request</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getParameter</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(</span><span style=\"--shiki-light:#50A14F;--shiki-dark:#98C379\">\"password\"</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">            </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#C18401;--shiki-dark:#E5C07B\">            UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E06C75\"> token</span><span style=\"--shiki-light:#383A42;--shiki-dark:#56B6C2\"> =</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\"> </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">                new</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\"> UsernamePasswordAuthenticationToken</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(username, password);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">                </span></span>\n<span class=\"line\"><span style=\"--shiki-light:#A626A4;--shiki-dark:#C678DD\">            return</span><span style=\"--shiki-light:#E45649;--shiki-dark:#E5C07B\"> this</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">.</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">getAuthenticationManager</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">().</span><span style=\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\">authenticate</span><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">(token);</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">        }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">    }</span></span>\n<span class=\"line\"><span style=\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\">}</span></span></code></pre>\n<div class=\"line-numbers\" aria-hidden=\"true\" style=\"counter-reset:line-number 0\"><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div><div class=\"line-number\"></div></div></div><h2 id=\"练习\" tabindex=\"-1\"><a class=\"header-anchor\" href=\"#练习\"><span>练习</span></a></h2>\n<ol>\n<li>\n<p>基础安全实践：</p>\n<ul>\n<li>实现用户认证</li>\n<li>实现角色授权</li>\n<li>实现记住我功能</li>\n</ul>\n</li>\n<li>\n<p>OAuth2 实践：</p>\n<ul>\n<li>实现 OAuth2 服务器</li>\n<li>实现 OAuth2 客户端</li>\n<li>实现第三方登录</li>\n</ul>\n</li>\n<li>\n<p>JWT 实践：</p>\n<ul>\n<li>实现 JWT 认证</li>\n<li>实现令牌刷新</li>\n<li>实现单点登录</li>\n</ul>\n</li>\n<li>\n<p>综合实践：</p>\n<ul>\n<li>实现完整的认证系统</li>\n<li>实现权限管理系统</li>\n<li>实现安全审计系统</li>\n</ul>\n</li>\n</ol>\n<div class=\"hint-container tip\">\n<p class=\"hint-container-title\">提示</p>\n<p>安全配置需要根据实际需求进行定制，建议遵循最小权限原则。</p>\n</div>\n<div class=\"hint-container info\">\n<p class=\"hint-container-title\">扩展阅读</p>\n<ul>\n<li><a href=\"https://docs.spring.io/spring-security/reference/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">Spring Security 官方文档</a></li>\n<li><a href=\"https://oauth.net/2/\" target=\"_blank\" rel=\"noopener noreferrer\">OAuth2 规范</a></li>\n<li><a href=\"https://jwt.io/\" target=\"_blank\" rel=\"noopener noreferrer\">JWT 规范</a></li>\n</ul>\n</div>\n</div></template>\n\n\n","import comp from \"/home/runner/work/healer-blog/healer-blog/src/.vuepress/.temp/pages/posts/java/spring/spring-security.html.vue\"\nconst data = JSON.parse(\"{\\\"path\\\":\\\"/posts/java/spring/spring-security.html\\\",\\\"title\\\":\\\"Spring Security\\\",\\\"lang\\\":\\\"zh-CN\\\",\\\"frontmatter\\\":{\\\"title\\\":\\\"Spring Security\\\",\\\"icon\\\":\\\"java\\\",\\\"category\\\":[\\\"Java 核心\\\"],\\\"tag\\\":[\\\"Java\\\",\\\"Spring\\\",\\\"安全\\\"],\\\"date\\\":\\\"2024-03-19T00:00:00.000Z\\\",\\\"description\\\":\\\"Spring Security 基础配置 1. 安全配置 2. 用户认证 3. 权限控制 高级特性 1. OAuth2 认证 2. JWT 认证 3. 自定义认证 练习 基础安全实践： 实现用户认证 实现角色授权 实现记住我功能 OAuth2 实践： 实现 OAuth2 服务器 实现 OAuth2 客户端 实现第三方登录 JWT 实践： 实现 JWT ...\\\",\\\"head\\\":[[\\\"meta\\\",{\\\"property\\\":\\\"og:url\\\",\\\"content\\\":\\\"https://healer07.github.io/healer-blog/posts/java/spring/spring-security.html\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:site_name\\\",\\\"content\\\":\\\"healer's blog\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:title\\\",\\\"content\\\":\\\"Spring Security\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:description\\\",\\\"content\\\":\\\"Spring Security 基础配置 1. 安全配置 2. 用户认证 3. 权限控制 高级特性 1. OAuth2 认证 2. JWT 认证 3. 自定义认证 练习 基础安全实践： 实现用户认证 实现角色授权 实现记住我功能 OAuth2 实践： 实现 OAuth2 服务器 实现 OAuth2 客户端 实现第三方登录 JWT 实践： 实现 JWT ...\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:type\\\",\\\"content\\\":\\\"article\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:locale\\\",\\\"content\\\":\\\"zh-CN\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"og:updated_time\\\",\\\"content\\\":\\\"2025-03-19T14:53:38.000Z\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"article:tag\\\",\\\"content\\\":\\\"Java\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"article:tag\\\",\\\"content\\\":\\\"Spring\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"article:tag\\\",\\\"content\\\":\\\"安全\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"article:published_time\\\",\\\"content\\\":\\\"2024-03-19T00:00:00.000Z\\\"}],[\\\"meta\\\",{\\\"property\\\":\\\"article:modified_time\\\",\\\"content\\\":\\\"2025-03-19T14:53:38.000Z\\\"}],[\\\"script\\\",{\\\"type\\\":\\\"application/ld+json\\\"},\\\"{\\\\\\\"@context\\\\\\\":\\\\\\\"https://schema.org\\\\\\\",\\\\\\\"@type\\\\\\\":\\\\\\\"Article\\\\\\\",\\\\\\\"headline\\\\\\\":\\\\\\\"Spring Security\\\\\\\",\\\\\\\"image\\\\\\\":[\\\\\\\"\\\\\\\"],\\\\\\\"datePublished\\\\\\\":\\\\\\\"2024-03-19T00:00:00.000Z\\\\\\\",\\\\\\\"dateModified\\\\\\\":\\\\\\\"2025-03-19T14:53:38.000Z\\\\\\\",\\\\\\\"author\\\\\\\":[{\\\\\\\"@type\\\\\\\":\\\\\\\"Person\\\\\\\",\\\\\\\"name\\\\\\\":\\\\\\\"Mr.Healer\\\\\\\",\\\\\\\"url\\\\\\\":\\\\\\\"https://healer07.github.io/healer-blog/\\\\\\\"}]}\\\"]]},\\\"git\\\":{\\\"createdTime\\\":1742396018000,\\\"updatedTime\\\":1742396018000,\\\"contributors\\\":[{\\\"name\\\":\\\"HEALER07\\\",\\\"username\\\":\\\"HEALER07\\\",\\\"email\\\":\\\"healer_wyn@163.com\\\",\\\"commits\\\":1,\\\"url\\\":\\\"https://github.com/HEALER07\\\"}]},\\\"readingTime\\\":{\\\"minutes\\\":2.6,\\\"words\\\":780},\\\"filePathRelative\\\":\\\"posts/java/spring/spring-security.md\\\",\\\"localizedDate\\\":\\\"2024年3月19日\\\",\\\"excerpt\\\":\\\"\\\\n<h2>基础配置</h2>\\\\n<h3>1. 安全配置</h3>\\\\n<div class=\\\\\\\"language-java line-numbers-mode\\\\\\\" data-highlighter=\\\\\\\"shiki\\\\\\\" data-ext=\\\\\\\"java\\\\\\\" style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\\\\\\"><pre class=\\\\\\\"shiki shiki-themes one-light one-dark-pro vp-code\\\\\\\"><code><span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">@</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\\\\\\\">Configuration</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">@</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\\\\\\\">EnableWebSecurity</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\">public</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> class</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\"> SecurityConfig</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> extends</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\"> WebSecurityConfigurerAdapter</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\"> {</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\\\\\\">    </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    @</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\\\\\\\">Override</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\">    protected</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> void</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\"> configure</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\">HttpSecurity</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\\\\\\\"> http</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> throws</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\"> Exception</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\"> {</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">        http</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">            // 1. 授权配置</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">authorizeRequests</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">antMatchers</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">, </span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/home\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">, </span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/public/**\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">permitAll</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">antMatchers</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/admin/**\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">hasRole</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"ADMIN\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">antMatchers</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/user/**\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">hasRole</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"USER\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">anyRequest</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">().</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">authenticated</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">and</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">            // 2. 登录配置</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">formLogin</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">loginPage</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/login\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">permitAll</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">and</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">            // 3. 登出配置</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">logout</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">logoutSuccessUrl</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">permitAll</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">and</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">            // 4. 记住我配置</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">rememberMe</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">tokenValiditySeconds</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#986801;--shiki-dark:#D19A66\\\\\\\">86400</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">and</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">            // 5. 异常处理</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">exceptionHandling</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">                .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">accessDeniedPage</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"/403\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">);</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    }</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\\\\\\">    </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    @</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\\\\\\\">Override</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\">    protected</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> void</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\"> configure</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\">AuthenticationManagerBuilder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic\\\\\\\"> auth</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> throws</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\"> Exception</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\"> {</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">        // 1. 内存认证</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#E45649;--shiki-dark:#E5C07B\\\\\\\">        auth</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">.</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">inMemoryAuthentication</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">withUser</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"user\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">password</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">passwordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">().</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">encode</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"password\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">roles</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"USER\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">and</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">withUser</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"admin\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">password</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">passwordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">().</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">encode</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"admin\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">)).</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">roles</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\\\\\\">\\\\\\\"ADMIN\\\\\\\"</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">);</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\\\\\\">        // 2. 数据库认证</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#E45649;--shiki-dark:#E5C07B\\\\\\\">        auth</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">.</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">userDetailsService</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(userDetailsService)</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">            .</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">passwordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">(</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\">passwordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">());</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    }</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#E06C75\\\\\\\">    </span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    @</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#E5C07B\\\\\\\">Bean</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\">    public</span><span style=\\\\\\\"--shiki-light:#C18401;--shiki-dark:#E5C07B\\\\\\\"> PasswordEncoder</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\"> passwordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">()</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\"> {</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\">        return</span><span style=\\\\\\\"--shiki-light:#A626A4;--shiki-dark:#C678DD\\\\\\\"> new</span><span style=\\\\\\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\\\\\\"> BCryptPasswordEncoder</span><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">();</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">    }</span></span>\\\\n<span class=\\\\\\\"line\\\\\\\"><span style=\\\\\\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\\\\\\">}</span></span></code></pre>\\\\n<div class=\\\\\\\"line-numbers\\\\\\\" aria-hidden=\\\\\\\"true\\\\\\\" style=\\\\\\\"counter-reset:line-number 0\\\\\\\"><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div><div class=\\\\\\\"line-number\\\\\\\"></div></div></div>\\\",\\\"autoDesc\\\":true}\")\nexport { comp, data }\n","import { render } from \"./spring-security.html.vue?vue&type=template&id=5d02bfe6\"\nconst script = {}\n\nimport exportComponent from \"../../../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["Object","defineProperty","exports","value","sfc","props","target","__vccOpts","key","val","data","JSON","parse","script","render"],"sourceRoot":""}